package com.java.JDBC.Insertion;

import java.sql.Connection;
import java.sql.DriverManager;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.Statement;

import com.mysql.cj.protocol.Resultset;

public class Customer {

	public static void main(String[] args) {
		// TODO Auto-generated method stub
		String name="Java";
		int age=25;
		String product="JDBC";
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");//1. Load JDBC driver
			//2. Define database URL //String url="jdbc:mysql://host_address:port/DataBaseName"
			String url="jdbc:mysql://localhost:3306/customer_db";
			//3. Establish a connection to the database URL using DriverManager.//getConnection(String url, String user, String password)
			Connection con = DriverManager.getConnection(url, "root", "admin");
			//4. Create the PreparedStatement object for sending parameterized SQL statements to the database. 
			//prepareStatement("insert into TableName(columns),values('"+values+"')")
			//PreparedStatement stmt=con.prepareStatement("insert into customer_table(c_name,c_age,c_product)values('"+name+"','"+age+"','"+product+"')");
			//Creates the Statement object for sendingSQL statements to the database.
			Statement st=con.createStatement();
			//5. Executes the SQL statement in this PreparedStatement object //PreparedStatementObject.executeUpdate()
			/* int i=stmt.executeUpdate();
			if(i>0) {
				System.out.println("Sucessfull");
			} else {
				System.out.println("Failed");
			} */
			//Executes the SQL statement, which returns a single ResultSet object. 
			ResultSet rs=st.executeQuery("select * from customer_db");
			while(rs.next())//Get column from each next row to Retrieve the value of the designated column of the ResultSet object 
				{
					System.out.println(rs.getInt(1));//getInt(int columnIndex)
					System.out.println(rs.getString(1));
				}
			con.close();//6.Close the connection with the specific database. 
		} catch (Exception e) {
			// TODO Auto-generated catch block
			e.printStackTrace();
		} 
	}

}
